{"version":3,"file":"NewArticle-CM8axW7p.js","sources":["../../src/views/app/news/NewArticle.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-6 space-y-6\">\r\n    <div class=\"flex items-center justify-between\">\r\n      <div>\r\n        <h1 class=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n          {{ isEdit ? 'Edit News Article' : 'Add News Article' }}\r\n        </h1>\r\n        <p class=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          {{ isEdit ? 'Update your news article' : 'Create a new news article for your network' }}\r\n        </p>\r\n      </div>\r\n      <router-link :to=\"{name:'News'}\" class=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 flex items-center\">\r\n        <ArrowLeftIcon class=\"h-4 w-4 mr-1\" />\r\n        Back to News\r\n      </router-link>\r\n    </div>\r\n    \r\n    <div class=\"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6\">\r\n      <form @submit.prevent=\"saveArticle\" class=\"space-y-6\">\r\n        <!-- Basic Information -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Article Information</h2>\r\n          \r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div class=\"md:col-span-2\">\r\n              <label for=\"title\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Article Title*</label>\r\n              <input\r\n                id=\"title\"\r\n                v-model=\"article.title\"\r\n                type=\"text\"\r\n                required\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"e.g. New Music Festival Coming This Summer\"\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label for=\"category_id\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Category</label>\r\n              <select\r\n                id=\"category_id\"\r\n                v-model=\"article.category_id\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n              >\r\n                <option value=\"\">Select a category</option>\r\n                <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\r\n                  {{ category.name }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label for=\"station_id\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Station</label>\r\n              <select\r\n                id=\"station_id\"\r\n                v-model=\"article.station_id\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n              >\r\n                <option value=\"\">Select a station</option>\r\n                <option v-for=\"station in stations\" :key=\"station.id\" :value=\"station.id\">\r\n                  {{ station.name }}\r\n                </option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Article Content -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Article Content</h2>\r\n          \r\n          <div>\r\n            <label for=\"summary\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Summary</label>\r\n            <textarea\r\n              id=\"summary\"\r\n              v-model=\"article.summary\"\r\n              rows=\"2\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"A brief summary of the article...\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div>\r\n            <label for=\"excerpt\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Excerpt</label>\r\n            <textarea\r\n              id=\"excerpt\"\r\n              v-model=\"article.excerpt\"\r\n              rows=\"2\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"Short excerpt for article previews...\"\r\n            ></textarea>\r\n          </div>\r\n          \r\n          <div>\r\n            <label for=\"content\" class=\"block text-sm font-medium text-white dark:text-gray-300 mb-1\">Full Content*</label>\r\n            <SummernoteEditor\r\n                v-model=\"article.content\"\r\n                :config=\"summernoteConfig\"\r\n                class=\"summernote-editor bg-white\"\r\n                @input=\"handleContentChange\"\r\n              />\r\n            <p class=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">Write your full article content</p>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- SEO Section -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">SEO Settings</h2>\r\n          \r\n          <div class=\"grid grid-cols-1 gap-4\">\r\n            <div>\r\n              <label for=\"meta_title\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Meta Title</label>\r\n              <input\r\n                id=\"meta_title\"\r\n                v-model=\"article.meta_title\"\r\n                type=\"text\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"SEO title (defaults to article title)\"\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label for=\"meta_description\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Meta Description</label>\r\n              <textarea\r\n                id=\"meta_description\"\r\n                v-model=\"article.meta_description\"\r\n                rows=\"2\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"SEO description (defaults to summary)\"\r\n              ></textarea>\r\n            </div>\r\n\r\n            <div>\r\n              <label for=\"meta_keywords\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Meta Keywords</label>\r\n              <input\r\n                id=\"meta_keywords\"\r\n                v-model=\"article.meta_keywords\"\r\n                type=\"text\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"SEO keywords, comma separated\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Featured Image -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Featured Image</h2>\r\n          \r\n          <div class=\"flex items-center space-x-6\">\r\n            <div class=\"h-32 w-32 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 relative\">\r\n              <img \r\n                v-if=\"featuredImagePreview\" \r\n                :src=\"featuredImagePreview\" \r\n                class=\"h-full w-full object-cover rounded-lg\" \r\n                alt=\"Featured image\"\r\n              />\r\n              <NewspaperIcon v-else class=\"h-12 w-12 text-gray-400\" />\r\n              \r\n              <!-- Remove button for existing image -->\r\n              <button\r\n                v-if=\"featuredImagePreview && !featuredImageFile\"\r\n                type=\"button\"\r\n                @click=\"removeFeaturedImage\"\r\n                class=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-6 w-6 flex items-center justify-center text-xs hover:bg-red-600\"\r\n              >\r\n                Ã—\r\n              </button>\r\n            </div>\r\n            \r\n            <div class=\"flex-1\">\r\n              <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Upload Featured Image</label>\r\n              <div class=\"flex items-center space-x-3\">\r\n                <label for=\"featured-image\" class=\"cursor-pointer bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none\">\r\n                  <span>Choose file</span>\r\n                  <input id=\"featured-image\" type=\"file\" class=\"sr-only\" accept=\"image/*\" @change=\"handleFeaturedImageUpload\" />\r\n                </label>\r\n                \r\n                <!-- Clear selected file button -->\r\n                <button\r\n                  v-if=\"featuredImageFile\"\r\n                  type=\"button\"\r\n                  @click=\"clearFeaturedImage\"\r\n                  class=\"px-3 py-2 text-sm text-red-600 hover:text-red-800\"\r\n                >\r\n                  Clear\r\n                </button>\r\n              </div>\r\n              <p class=\"ml-0 mt-1 text-xs text-gray-500 dark:text-gray-400\">PNG, JPG, GIF up to 2MB (1200x630px recommended)</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Gallery Images -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Gallery Images</h2>\r\n          \r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Upload Gallery Images</label>\r\n            <div class=\"flex items-center space-x-3\">\r\n              <label for=\"gallery-images\" class=\"cursor-pointer bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none\">\r\n                <span>Choose files</span>\r\n                <input id=\"gallery-images\" type=\"file\" class=\"sr-only\" accept=\"image/*\" multiple @change=\"handleGalleryImagesUpload\" />\r\n              </label>\r\n              \r\n              <!-- Clear all gallery images button -->\r\n              <button\r\n                v-if=\"galleryImageFiles.length > 0 || (article.gallery_images && article.gallery_images.length > 0)\"\r\n                type=\"button\"\r\n                @click=\"clearAllGalleryImages\"\r\n                class=\"px-3 py-2 text-sm text-red-600 hover:text-red-800\"\r\n              >\r\n                Clear All\r\n              </button>\r\n            </div>\r\n            <p class=\"ml-0 mt-1 text-xs text-gray-500 dark:text-gray-400\">Select multiple images for gallery</p>\r\n          </div>\r\n\r\n          <!-- Gallery Preview -->\r\n          <div v-if=\"galleryImageFiles.length > 0 || (article.gallery_images && article.gallery_images.length > 0)\" class=\"grid grid-cols-4 gap-4\">\r\n            <!-- Existing gallery images (only show if not replacing) -->\r\n            <div v-for=\"(image, index) in (isReplacingGallery ? [] : article.gallery_images || [])\" :key=\"'existing-' + index\" class=\"relative\">\r\n              <img :src=\"image.url\" class=\"h-20 w-20 object-cover rounded-lg\" alt=\"Gallery image\" />\r\n              <button\r\n                type=\"button\"\r\n                @click=\"removeExistingGalleryImage(image.id)\"\r\n                class=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs hover:bg-red-600\"\r\n              >\r\n                Ã—\r\n              </button>\r\n            </div>\r\n            \r\n            <!-- New gallery images -->\r\n            <div v-for=\"(preview, index) in galleryPreviews\" :key=\"'new-' + index\" class=\"relative\">\r\n              <img :src=\"preview\" class=\"h-20 w-20 object-cover rounded-lg\" alt=\"Gallery preview\" />\r\n              <button\r\n                type=\"button\"\r\n                @click=\"removeGalleryPreview(index)\"\r\n                class=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs hover:bg-red-600\"\r\n              >\r\n                Ã—\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Publishing Details -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Publishing Details</h2>\r\n          \r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label for=\"priority\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Priority</label>\r\n              <input\r\n                id=\"priority\"\r\n                v-model=\"article.priority\"\r\n                type=\"number\"\r\n                min=\"0\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"0\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label for=\"source\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Source</label>\r\n              <input\r\n                id=\"source\"\r\n                v-model=\"article.source\"\r\n                type=\"text\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"e.g. Reuters, BBC, etc.\"\r\n              />\r\n            </div>\r\n\r\n            <div class=\"md:col-span-2\">\r\n              <label for=\"source_url\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Source URL</label>\r\n              <input\r\n                id=\"source_url\"\r\n                v-model=\"article.source_url\"\r\n                type=\"url\"\r\n                class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                placeholder=\"https://example.com/original-article\"\r\n              />\r\n            </div>\r\n            \r\n            <div class=\"md:col-span-2 space-y-3\">\r\n              <label class=\"flex items-center\">\r\n                <input\r\n                  v-model=\"article.is_published\"\r\n                  type=\"checkbox\"\r\n                  class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                />\r\n                <span class=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">Publish this article</span>\r\n              </label>\r\n\r\n              <label class=\"flex items-center\">\r\n                <input\r\n                  v-model=\"article.is_featured\"\r\n                  type=\"checkbox\"\r\n                  class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                />\r\n                <span class=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">Feature this article on homepage</span>\r\n              </label>\r\n\r\n              <label class=\"flex items-center\">\r\n                <input\r\n                  v-model=\"article.is_breaking\"\r\n                  type=\"checkbox\"\r\n                  class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                />\r\n                <span class=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">Mark as breaking news</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Tags -->\r\n        <div class=\"space-y-4\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2\">Tags</h2>\r\n          \r\n          <div>\r\n            <label for=\"tags\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Article Tags</label>\r\n            <input\r\n              id=\"tags\"\r\n              v-model=\"tagsString\"\r\n              type=\"text\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n              placeholder=\"e.g. music, festival, summer (comma separated)\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Submit Buttons -->\r\n        <div class=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n          <router-link to=\"/dashboard/news\" class=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\">\r\n            Cancel\r\n          </router-link>\r\n          <button \r\n            type=\"submit\" \r\n            :disabled=\"loading === 'createarticle' || loading === 'updatearticle'\"\r\n            class=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-500 hover:from-blue-700 hover:to-purple-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            {{ loading === 'createarticle' || loading === 'updatearticle' ? 'Saving...' : (isEdit ? 'Update Article' : 'Save Article') }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, watch } from 'vue';\r\nimport { useRouter, useRoute } from 'vue-router';\r\nimport { useStore } from 'vuex';\r\nimport { ArrowLeft as ArrowLeftIcon, Newspaper as NewspaperIcon } from 'lucide-vue-next';\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst store = useStore();\r\n\r\n// Computed properties\r\nconst loading = computed(() => store.getters.loading);\r\nconst categories = computed(() => store.getters.categories || []);\r\nconst stations = computed(() => store.getters.stations || []);\r\nconst isEdit = computed(() => !!route.params.id);\r\n\r\n// Reactive data\r\nconst article = ref({\r\n  title: '',\r\n  summary: '',\r\n  excerpt: '',\r\n  content: '',\r\n  meta_title: '',\r\n  meta_description: '',\r\n  meta_keywords: '',\r\n  category_id: '',\r\n  station_id: '',\r\n  source: '',\r\n  source_url: '',\r\n  priority: 0,\r\n  is_published: false,\r\n  is_featured: false,\r\n  is_breaking: false,\r\n  featured_image_url: '',\r\n  gallery_images: []\r\n});\r\n\r\nconst featuredImageFile = ref(null);\r\nconst galleryImageFiles = ref([]);\r\nconst featuredImagePreview = ref('');\r\nconst galleryPreviews = ref([]);\r\nconst tagsString = ref('');\r\nconst isReplacingGallery = ref(false);\r\n\r\nconst summernoteConfig = ref({\r\n    height: 300,\r\n    toolbar: [\r\n      ['style', ['style']],\r\n      ['font', ['bold', 'underline', 'clear']],\r\n      ['fontname', ['fontname']],\r\n      ['color', ['color']],\r\n      ['para', ['ul', 'ol', 'paragraph']],\r\n      ['table', ['table']],\r\n      ['insert', ['link', 'picture', 'video']],\r\n      ['view', ['fullscreen', 'codeview', 'help']]\r\n    ],\r\n    placeholder: 'Write your article content here...',\r\n    fontNames: ['Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Helvetica', 'Impact', 'Tahoma', 'Times New Roman', 'Verdana'],\r\n    fontSizes: ['8', '9', '10', '11', '12', '14', '18', '24', '36'],\r\n    callbacks: {\r\n      onImageUpload: function(files) {\r\n        // Handle image upload in the editor\r\n        for (let i = 0; i < files.length; i++) {\r\n          const file = files[i];\r\n          // You can implement image upload to your server here\r\n          // For now, we'll create a local URL\r\n          const reader = new FileReader();\r\n          reader.onload = function(e) {\r\n            $(this).summernote('insertImage', e.target.result);\r\n          }.bind(this);\r\n          reader.readAsDataURL(file);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  \r\n  const handleContentChange = (content) => {\r\n    article.value.content = content;\r\n  };\r\n\r\n// Methods\r\nconst handleFeaturedImageUpload = (event) => {\r\n  const file = event.target.files[0];\r\n  if (file) {\r\n    featuredImageFile.value = file;\r\n    featuredImagePreview.value = URL.createObjectURL(file);\r\n  }\r\n};\r\n\r\nconst removeFeaturedImage = () => {\r\n  article.value.featured_image_url = '';\r\n  featuredImagePreview.value = '';\r\n  featuredImageFile.value = null;\r\n  // Reset the file input\r\n  const fileInput = document.getElementById('featured-image');\r\n  if (fileInput) fileInput.value = '';\r\n};\r\n\r\nconst clearFeaturedImage = () => {\r\n  featuredImageFile.value = null;\r\n  featuredImagePreview.value = article.value.featured_image_url || '';\r\n  // Reset the file input\r\n  const fileInput = document.getElementById('featured-image');\r\n  if (fileInput) fileInput.value = '';\r\n};\r\n\r\nconst handleGalleryImagesUpload = (event) => {\r\n  const files = Array.from(event.target.files);\r\n  \r\n  // If this is the first time adding new images after existing ones, mark as replacing\r\n  if (article.value.gallery_images && article.value.gallery_images.length > 0 && galleryImageFiles.value.length === 0) {\r\n    isReplacingGallery.value = true;\r\n  }\r\n  \r\n  galleryImageFiles.value = [...galleryImageFiles.value, ...files];\r\n  \r\n  files.forEach(file => {\r\n    galleryPreviews.value.push(URL.createObjectURL(file));\r\n  });\r\n};\r\n\r\nconst removeGalleryPreview = (index) => {\r\n  // Revoke the object URL to prevent memory leaks\r\n  URL.revokeObjectURL(galleryPreviews.value[index]);\r\n  galleryPreviews.value.splice(index, 1);\r\n  galleryImageFiles.value.splice(index, 1);\r\n  \r\n  // Reset the file input\r\n  const fileInput = document.getElementById('gallery-images');\r\n  if (fileInput) fileInput.value = '';\r\n};\r\n\r\nconst removeExistingGalleryImage = async (imageId) => {\r\n  if (confirm('Are you sure you want to remove this image?')) {\r\n    try {\r\n      await store.dispatch('removegalleryimage', { \r\n        articleId: route.params.id, \r\n        imageId: imageId \r\n      });\r\n      // Refresh article data\r\n      await fetchArticle();\r\n    } catch (error) {\r\n      console.error('Error removing gallery image:', error);\r\n    }\r\n  }\r\n};\r\n\r\nconst clearAllGalleryImages = () => {\r\n  // Clear new images\r\n  galleryPreviews.value.forEach(preview => URL.revokeObjectURL(preview));\r\n  galleryPreviews.value = [];\r\n  galleryImageFiles.value = [];\r\n  \r\n  // Clear existing images\r\n  article.value.gallery_images = [];\r\n  isReplacingGallery.value = true;\r\n  \r\n  // Reset the file input\r\n  const fileInput = document.getElementById('gallery-images');\r\n  if (fileInput) fileInput.value = '';\r\n};\r\n\r\nconst fetchArticle = async () => {\r\n  if (isEdit.value) {\r\n    try {\r\n      await store.dispatch('fetcharticle', route.params.id);\r\n      const fetchedArticle = store.getters.article;\r\n      \r\n      if (fetchedArticle) {\r\n        article.value = {\r\n          ...fetchedArticle,\r\n          category_id: fetchedArticle.category?.id || '',\r\n          station_id: fetchedArticle.station?.id || ''\r\n        };\r\n        \r\n        // Set featured image preview\r\n        featuredImagePreview.value = fetchedArticle.featured_image_url || '';\r\n        \r\n        // Convert tags array to string\r\n        if (fetchedArticle.tags) {\r\n          tagsString.value = fetchedArticle.tags.join(', ');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching article:', error);\r\n      router.push({name:'News'});\r\n    }\r\n  }\r\n};\r\n\r\nconst fetchCategories = async () => {\r\n  try {\r\n    await store.dispatch('fetchcategories');\r\n  } catch (error) {\r\n    console.error('Error fetching categories:', error);\r\n  }\r\n};\r\n\r\nconst fetchStations = async () => {\r\n  let data = {\r\n    per_page: 100\r\n  }\r\n  let page = 1\r\n  try {\r\n    await store.dispatch('fetch_stations', {\r\n      data,\r\n      page\r\n    });\r\n  } catch (error) {\r\n    console.error('Failed to fetch stations:', error);\r\n    store.dispatch('template_play_error_file', 'Failed to load stations');\r\n  }\r\n};\r\n\r\nconst saveArticle = async () => {\r\n  try {\r\n    // Prepare form data\r\n    const formData = new FormData();\r\n    \r\n    // Add text fields\r\n    Object.keys(article.value).forEach(key => {\r\n      if (key !== 'gallery_images' && article.value[key] !== null && article.value[key] !== '') {\r\n        if (typeof article.value[key] === 'boolean') {\r\n          formData.append(key, article.value[key] ? 'true' : 'false');\r\n        } else {\r\n          formData.append(key, article.value[key]);\r\n        }\r\n      }\r\n    });\r\n\r\n    // Add tags as JSON string\r\n    if (tagsString.value) {\r\n      const tagsArray = tagsString.value.split(',').map(tag => tag.trim()).filter(tag => tag);\r\n      formData.append('tags', JSON.stringify(tagsArray));\r\n    }\r\n\r\n    // Add featured image if new one is selected\r\n    if (featuredImageFile.value) {\r\n      formData.append('featured_image', featuredImageFile.value);\r\n    }\r\n\r\n    // Add gallery images if new ones are selected\r\n    if (galleryImageFiles.value.length > 0) {\r\n      galleryImageFiles.value.forEach((file, index) => {\r\n        formData.append(`gallery_image_${index}`, file);\r\n      });\r\n      \r\n      // If replacing gallery, add a flag\r\n      if (isReplacingGallery.value) {\r\n        formData.append('replace_gallery', 'true');\r\n      }\r\n    }\r\n\r\n    if (isEdit.value) {\r\n      await store.dispatch('updatearticle', { \r\n        id: route.params.id, \r\n        data: formData \r\n      });\r\n    } else {\r\n      await store.dispatch('createarticle', formData);\r\n    }\r\n\r\n    router.push({name:'News'});\r\n  } catch (error) {\r\n    console.error('Error saving article:', error);\r\n  }\r\n};\r\n\r\n// Watch for meta title/description auto-fill\r\nwatch(() => article.value.title, (newTitle) => {\r\n  if (!article.value.meta_title) {\r\n    article.value.meta_title = newTitle;\r\n  }\r\n});\r\n\r\nwatch(() => article.value.summary, (newSummary) => {\r\n  if (!article.value.meta_description) {\r\n    article.value.meta_description = newSummary;\r\n  }\r\n});\r\n\r\n// Lifecycle\r\nonMounted(() => {\r\n  fetchCategories();\r\n  fetchStations();\r\n  if (isEdit.value) {\r\n    fetchArticle();\r\n  }\r\n});\r\n</script>\r\n<style scoped>\r\n\r\n\r\n/* Summernote editor styling */\r\n:deep(.note-editor) {\r\n  border: 1px solid #d1d5db;\r\n}\r\n\r\n:deep(.note-toolbar) {\r\n  background-color: #f9fafb;\r\n  border-bottom: 1px solid #d1d5db;\r\n}\r\n\r\n:deep(.note-editing-area) {\r\n  background-color: white;\r\n}\r\n\r\n/* Dark mode styles */\r\n.dark :deep(.note-editor) {\r\n  border: 1px solid #4b5563;\r\n  background-color: #374151;\r\n}\r\n\r\n.dark :deep(.note-toolbar) {\r\n  background-color: #374151;\r\n  border-bottom: 1px solid #4b5563;\r\n}\r\n\r\n.dark :deep(.note-editing-area) {\r\n  background-color: #374151;\r\n}\r\n\r\n.dark :deep(.note-editable) {\r\n  background-color: #374151;\r\n  color: #f9fafb;\r\n}\r\n\r\n.dark :deep(.note-btn) {\r\n  color: #f9fafb;\r\n  background-color: transparent;\r\n  border-color: #4b5563;\r\n}\r\n\r\n.dark :deep(.note-btn:hover) {\r\n  background-color: #4b5563;\r\n}\r\n\r\n.dark :deep(.dropdown-menu) {\r\n  background-color: #374151;\r\n  border-color: #4b5563;\r\n}\r\n\r\n.dark :deep(.dropdown-item) {\r\n  color: #f9fafb;\r\n}\r\n\r\n.dark :deep(.dropdown-item:hover) {\r\n  background-color: #4b5563;\r\n}\r\n</style>"],"names":["router","useRouter","route","useRoute","store","useStore","loading","computed","categories","stations","isEdit","article","ref","featuredImageFile","galleryImageFiles","featuredImagePreview","galleryPreviews","tagsString","isReplacingGallery","summernoteConfig","files","i","file","reader","e","handleContentChange","content","handleFeaturedImageUpload","event","removeFeaturedImage","fileInput","clearFeaturedImage","handleGalleryImagesUpload","removeGalleryPreview","index","removeExistingGalleryImage","imageId","fetchArticle","error","clearAllGalleryImages","preview","fetchedArticle","_a","_b","fetchCategories","fetchStations","data","page","saveArticle","formData","key","tagsArray","tag","watch","newTitle","newSummary","onMounted"],"mappings":"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"}