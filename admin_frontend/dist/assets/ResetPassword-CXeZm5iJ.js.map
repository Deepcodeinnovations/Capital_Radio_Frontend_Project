{"version":3,"file":"ResetPassword-CXeZm5iJ.js","sources":["../../node_modules/lucide-vue-next/dist/esm/icons/key-round.js","../../src/views/auth/ResetPassword.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.511.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst KeyRound = createLucideIcon(\"key-round\", [\n  [\n    \"path\",\n    {\n      d: \"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z\",\n      key: \"1s6t7t\"\n    }\n  ],\n  [\"circle\", { cx: \"16.5\", cy: \"7.5\", r: \".5\", fill: \"currentColor\", key: \"w0ekpg\" }]\n]);\n\nexport { KeyRound as default };\n//# sourceMappingURL=key-round.js.map\n","<template>\r\n  <div class=\"max-w-md w-full space-y-6 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm p-10 rounded-xl shadow-2xl border border-purple-200 dark:border-slate-700\">\r\n    <!-- Header -->\r\n    <div class=\"text-center\">\r\n      <div class=\"mx-auto w-12 h-12 bg-gradient-to-r from-purple-600 to-orange-500 rounded-full flex items-center justify-center mb-4\">\r\n        <KeyRoundIcon class=\"w-6 h-6 text-white\" />\r\n      </div>\r\n      <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white\">Forgot Password?</h2>\r\n      <p class=\"text-gray-600 dark:text-gray-300 mt-1 max-w-sm mx-auto\">\r\n        Enter your admin email address and we'll send you a verification code to reset your password.\r\n      </p>\r\n    </div>\r\n\r\n    <!-- Success Message -->\r\n    <div v-if=\"emailSent\" class=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\r\n      <div class=\"flex items-start\">\r\n        <CheckCircleIcon class=\"h-5 w-5 text-green-500 mr-3 flex-shrink-0 mt-0.5\" />\r\n        <div>\r\n          <h4 class=\"font-medium text-green-900 dark:text-green-200 mb-1\">Reset code sent!</h4>\r\n          <p class=\"text-sm text-green-700 dark:text-green-300\">\r\n            We've sent a password reset code to <strong>{{ form.email }}</strong>. \r\n            Please check your email and enter the code on the next page.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n \r\n    <!-- Error Alert -->\r\n    <div v-if=\"errorMessage\" class=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\r\n      <div class=\"flex items-center\">\r\n        <AlertCircleIcon class=\"h-5 w-5 text-red-500 mr-2\" />\r\n        <span class=\"text-sm text-red-700 dark:text-red-400\">{{ errorMessage }}</span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Form (hidden after successful submission) -->        \r\n    <form v-if=\"!emailSent\" class=\"space-y-6\" @submit.prevent=\"handleForgotPassword\">\r\n      <!-- Email Field -->\r\n      <div>\r\n        <label for=\"email\" class=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">\r\n          Admin Email Address\r\n        </label>\r\n        <div class=\"relative\">\r\n          <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n            <MailIcon class=\"h-5 w-5 text-purple-400 dark:text-purple-300\" />\r\n          </div>\r\n          <input\r\n            id=\"email\"\r\n            name=\"email\"\r\n            type=\"email\"\r\n            autocomplete=\"email\"\r\n            required\r\n            v-model=\"form.email\"\r\n            @input=\"clearError\"\r\n            class=\"block w-full pl-10 pr-3 py-3 border border-gray-300 dark:border-slate-600 rounded-lg shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200\"\r\n            :class=\"{ 'border-red-300 focus:ring-red-500': errorMessage }\"\r\n            placeholder=\"Enter your admin email address\"\r\n          />\r\n        </div>\r\n        <p class=\"mt-2 text-xs text-gray-500 dark:text-gray-400\">\r\n          Enter the email address associated with your admin account\r\n        </p>\r\n      </div>\r\n \r\n      <!-- Submit Button -->\r\n      <button\r\n        type=\"submit\"\r\n        :disabled=\"isLoading || !form.email.trim()\"\r\n        class=\"relative w-full flex justify-center items-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\"\r\n      >\r\n        <LoaderIcon v-if=\"isLoading\" class=\"w-5 h-5 mr-2 animate-spin\" />\r\n        <SendIcon v-else class=\"w-5 h-5 mr-2\" />\r\n        {{ isLoading ? 'Sending...' : 'Send Reset Code' }}\r\n      </button>\r\n    </form>\r\n\r\n    <!-- Success State Actions -->\r\n    <div v-if=\"emailSent\" class=\"space-y-4\">\r\n      <button\r\n        @click=\"resendEmail\"\r\n        :disabled=\"isResending || resendCooldown > 0\"\r\n        class=\"w-full bg-white dark:bg-slate-700 border border-gray-300 dark:border-slate-600 hover:bg-gray-50 dark:hover:bg-slate-600 disabled:bg-gray-100 dark:disabled:bg-slate-800 text-gray-700 dark:text-gray-300 disabled:text-gray-400 dark:disabled:text-gray-500 font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed\"\r\n      >\r\n        <LoaderIcon v-if=\"isResending\" class=\"animate-spin h-5 w-5 mr-2\" />\r\n        <RotateCcwIcon v-else class=\"w-5 h-5 mr-2\" />\r\n        <span v-if=\"resendCooldown > 0\">\r\n          Resend in {{ resendCooldown }}s\r\n        </span>\r\n        <span v-else-if=\"isResending\">\r\n          Sending...\r\n        </span>\r\n        <span v-else>\r\n          Resend email\r\n        </span>\r\n      </button>\r\n\r\n      <button\r\n        @click=\"goToVerifyCode\"\r\n        class=\"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center shadow-lg hover:shadow-xl transform hover:-translate-y-0.5\"\r\n      >\r\n        <KeyRoundIcon class=\"w-5 h-5 mr-2\" />\r\n        <span>Enter Verification Code</span>\r\n      </button>\r\n\r\n      <div class=\"text-center\">\r\n        <p class=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">Didn't receive the email?</p>\r\n        <ul class=\"text-xs text-gray-500 dark:text-gray-400 space-y-1\">\r\n          <li>• Check your spam or junk folder</li>\r\n          <li>• Make sure you entered the correct email address</li>\r\n          <li>• Contact IT support if you continue having issues</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Divider -->\r\n    <div class=\"mt-8 mb-6\">\r\n      <div class=\"relative\">\r\n        <div class=\"absolute inset-0 flex items-center\">\r\n          <div class=\"w-full border-t border-gray-200 dark:border-slate-600\"></div>\r\n        </div>\r\n        <div class=\"relative flex justify-center text-sm\">\r\n          <span class=\"px-4 bg-white dark:bg-slate-800 text-gray-500 dark:text-gray-400\">Remember your password?</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n \r\n    <!-- Back to Login -->\r\n    <div class=\"text-center\">\r\n      <router-link \r\n        :to=\"{ name: 'Login' }\" \r\n        class=\"inline-flex items-center text-purple-600 hover:text-purple-500 dark:text-purple-400 dark:hover:text-purple-300 transition-colors font-medium text-sm\"\r\n      >\r\n        <ArrowLeftIcon class=\"w-4 h-4 mr-2\" />\r\n        Back to admin sign in\r\n      </router-link>\r\n    </div>\r\n\r\n    <!-- Support -->\r\n    <div class=\"mt-6 text-center\">\r\n      <p class=\"text-xs text-gray-500 dark:text-gray-400\">\r\n        Need help? \r\n        <a href=\"mailto:support@capitalradio.co.ug\" class=\"text-purple-600 hover:text-purple-500 dark:text-purple-400 dark:hover:text-purple-300 transition-colors font-medium\">\r\n          Contact IT support\r\n        </a>\r\n      </p>\r\n    </div>\r\n  </div>\r\n</template>\r\n \r\n<script setup>\r\nimport { ref, reactive, onUnmounted } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\nimport { \r\n  Loader as LoaderIcon, \r\n  Mail as MailIcon,\r\n  AlertCircle as AlertCircleIcon,\r\n  CheckCircle as CheckCircleIcon,\r\n  KeyRound as KeyRoundIcon,\r\n  Send as SendIcon,\r\n  RotateCcw as RotateCcwIcon,\r\n  ArrowLeft as ArrowLeftIcon\r\n} from 'lucide-vue-next';\r\n \r\nconst store = useStore();\r\nconst router = useRouter();\r\n\r\nconst form = reactive({\r\n  email: ''\r\n});\r\n\r\nconst emailSent = ref(false);\r\nconst isLoading = ref(false);\r\nconst isResending = ref(false);\r\nconst errorMessage = ref('');\r\nconst resendCooldown = ref(0);\r\n\r\nlet cooldownInterval = null;\r\n\r\n// Clear error message when user types\r\nconst clearError = () => {\r\n  if (errorMessage.value) {\r\n    errorMessage.value = '';\r\n  }\r\n};\r\n\r\nconst handleForgotPassword = async () => {\r\n  try {\r\n    isLoading.value = true;\r\n    errorMessage.value = '';\r\n    \r\n    // Validate email format\r\n    if (!form.email.includes('@')) {\r\n      throw new Error('Please enter a valid email address');\r\n    }\r\n    \r\n    // Call the forgot admin password API directly\r\n    await store.dispatch('forgotAdminPassword', form.email.trim());\r\n    \r\n    // Show success state\r\n    emailSent.value = true;\r\n    \r\n  } catch (error) {\r\n    console.error('Forgot password error:', error);\r\n    \r\n    // Set error message from store or default\r\n    errorMessage.value = store.getters.error || error.message || 'Failed to send reset code. Please try again.';\r\n    \r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\nconst resendEmail = async () => {\r\n  try {\r\n    isResending.value = true;\r\n    errorMessage.value = '';\r\n    \r\n    // Call the forgot password API again\r\n    await store.dispatch('forgotAdminPassword', form.email.trim());\r\n    \r\n    // Start cooldown\r\n    startResendCooldown();\r\n    \r\n  } catch (error) {\r\n    console.error('Resend error:', error);\r\n    errorMessage.value = store.getters.error || error.message || 'Failed to resend email. Please try again.';\r\n  } finally {\r\n    isResending.value = false;\r\n  }\r\n};\r\n\r\nconst goToVerifyCode = () => {\r\n  router.push({ name: 'VerifyOTP', query: { email: form.email.trim() } });\r\n};\r\n\r\nconst startResendCooldown = () => {\r\n  resendCooldown.value = 60; // 60 seconds cooldown\r\n  \r\n  cooldownInterval = setInterval(() => {\r\n    resendCooldown.value--;\r\n    if (resendCooldown.value <= 0) {\r\n      clearInterval(cooldownInterval);\r\n      cooldownInterval = null;\r\n    }\r\n  }, 1000);\r\n};\r\n\r\n// Cleanup interval on component unmount\r\nonUnmounted(() => {\r\n  if (cooldownInterval) {\r\n    clearInterval(cooldownInterval);\r\n  }\r\n});\r\n</script>"],"names":["KeyRound","createLucideIcon","store","useStore","router","useRouter","form","reactive","emailSent","ref","isLoading","isResending","errorMessage","resendCooldown","cooldownInterval","clearError","handleForgotPassword","error","resendEmail","startResendCooldown","goToVerifyCode","onUnmounted"],"mappings":"0hBAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAWC,EAAiB,YAAa,CAC7C,CACE,OACA,CACE,EAAG,6KACH,IAAK,QACX,CACG,EACD,CAAC,SAAU,CAAE,GAAI,OAAQ,GAAI,MAAO,EAAG,KAAM,KAAM,eAAgB,IAAK,QAAU,CAAA,CACpF,CAAC,g8BCkJD,MAAMC,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAElBC,EAAOC,EAAS,CACpB,MAAO,EACT,CAAC,EAEKC,EAAYC,EAAI,EAAK,EACrBC,EAAYD,EAAI,EAAK,EACrBE,EAAcF,EAAI,EAAK,EACvBG,EAAeH,EAAI,EAAE,EACrBI,EAAiBJ,EAAI,CAAC,EAE5B,IAAIK,EAAmB,KAGvB,MAAMC,EAAa,IAAM,CACnBH,EAAa,QACfA,EAAa,MAAQ,GAEzB,EAEMI,EAAuB,SAAY,CACvC,GAAI,CAKF,GAJAN,EAAU,MAAQ,GAClBE,EAAa,MAAQ,GAGjB,CAACN,EAAK,MAAM,SAAS,GAAG,EAC1B,MAAM,IAAI,MAAM,oCAAoC,EAItD,MAAMJ,EAAM,SAAS,sBAAuBI,EAAK,MAAM,KAAI,CAAE,EAG7DE,EAAU,MAAQ,EAEnB,OAAQS,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAG7CL,EAAa,MAAQV,EAAM,QAAQ,OAASe,EAAM,SAAW,8CAEjE,QAAY,CACRP,EAAU,MAAQ,EACnB,CACH,EAEMQ,EAAc,SAAY,CAC9B,GAAI,CACFP,EAAY,MAAQ,GACpBC,EAAa,MAAQ,GAGrB,MAAMV,EAAM,SAAS,sBAAuBI,EAAK,MAAM,KAAI,CAAE,EAG7Da,GAED,OAAQF,EAAO,CACd,QAAQ,MAAM,gBAAiBA,CAAK,EACpCL,EAAa,MAAQV,EAAM,QAAQ,OAASe,EAAM,SAAW,2CACjE,QAAY,CACRN,EAAY,MAAQ,EACrB,CACH,EAEMS,EAAiB,IAAM,CAC3BhB,EAAO,KAAK,CAAE,KAAM,YAAa,MAAO,CAAE,MAAOE,EAAK,MAAM,KAAM,CAAA,CAAI,CAAA,CACxE,EAEMa,EAAsB,IAAM,CAChCN,EAAe,MAAQ,GAEvBC,EAAmB,YAAY,IAAM,CACnCD,EAAe,QACXA,EAAe,OAAS,IAC1B,cAAcC,CAAgB,EAC9BA,EAAmB,KAEtB,EAAE,GAAI,CACT,EAGA,OAAAO,EAAY,IAAM,CACZP,GACF,cAAcA,CAAgB,CAElC,CAAC","x_google_ignoreList":[0]}