import{u as Q,f as v,g as C,p as W,r as Y,c as r,o,b as t,h as k,d as p,k as j,i,w as y,B as V,F,s as S,t as n,j as Z,n as E,l as M,m as U,v as B,C as ee}from"./index-nOqVMhSP.js";import{P as te}from"./plus-DuFhQe66.js";import{L as A}from"./loader-CmDhcKWI.js";import{T as ae,a as se}from"./toggle-right-Dl0JYHjI.js";import{S as oe}from"./square-pen-BYKpSTKJ.js";import{T as re}from"./trash-CULHkSjr.js";import{M as le}from"./message-square-65oRwxfY.js";import{X as ne}from"./x-D4KeTYyF.js";import{T as ie}from"./triangle-alert-CWfHv5fj.js";import"./createLucideIcon-BxhE3_JV.js";const de={class:"p-6 bg-white dark:bg-slate-800 rounded-lg shadow-lg"},ue={class:"flex justify-between items-center mb-6"},ge={class:"mb-6 flex flex-wrap gap-4"},ce=["value"],pe={key:0,class:"flex justify-center py-8"},me={key:1,class:"space-y-4"},be={class:"flex justify-between items-start"},xe={class:"flex-1"},ve={class:"font-semibold text-gray-900 dark:text-white"},ye={class:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 px-2 py-1 rounded-full text-xs font-medium"},fe={class:"text-gray-600 dark:text-gray-300 text-sm line-clamp-2"},ke={class:"flex items-center gap-4 mt-2 text-xs text-gray-500 dark:text-gray-400"},he={class:"flex items-center gap-2 ml-4"},we=["onClick","disabled"],_e=["onClick"],Ce=["onClick"],Fe={key:0,class:"flex justify-center mt-6"},Se={class:"flex items-center gap-2"},Me=["onClick","disabled"],De={key:2,class:"text-center py-12"},Te={class:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-slate-600"},je={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ve=["value"],Ee={class:"flex items-center"},Ue={class:"flex justify-end gap-3 pt-4"},Ae=["disabled"],Ne={class:"p-6"},$e={class:"flex items-center mb-4"},qe={class:"text-gray-600 dark:text-gray-300 mb-6"},Be={class:"flex justify-end gap-3"},Le=["disabled"],We={__name:"Forums",setup(Pe){const d=Q(),h=v(!1),f=v(!1),m=v(null),w=v(null),x=v({station_id:"",status:"",page:1}),l=v({title:"",body:"",station_id:"",status:!0}),g=C(()=>d.getters.forums),c=C(()=>d.getters.loading),D=C(()=>d.getters.stations||[]),L=C(()=>{var e;if(!((e=g.value)!=null&&e.last_page))return[];const s=[];for(let u=1;u<=g.value.last_page;u++)s.push(u);return s}),P=s=>{const e=D.value.find(u=>u.id===s);return e?e.name:"Unknown Station"},z=async()=>{let s={per_page:100},e=1;try{await d.dispatch("fetch_stations",{data:s,page:e})}catch(u){console.error("Failed to fetch stations:",u),d.dispatch("template_play_error_file","Failed to load stations")}},b=async()=>{await d.dispatch("fetchForums",x.value)},I=s=>new Date(s).toLocaleDateString(),R=()=>{m.value=null,l.value={title:"",body:"",station_id:"",status:!0},h.value=!0},X=s=>{m.value=s,l.value={title:s.title,body:s.body,station_id:s.station_id,status:s.status},h.value=!0},_=()=>{h.value=!1,m.value=null},G=async()=>{try{m.value?await d.dispatch("updateForum",{id:m.value.id,data:l.value}):await d.dispatch("createForum",l.value),_(),await b()}catch(s){console.error("Error submitting form:",s)}},H=async s=>{try{await d.dispatch("updateForum",{id:s.id,data:{...s,status:!s.status}}),await b()}catch(e){console.error("Error toggling status:",e)}},J=s=>{w.value=s,f.value=!0},K=async()=>{try{await d.dispatch("deleteForum",w.value.id),f.value=!1,w.value=null,await b()}catch(s){console.error("Error deleting forum:",s)}},O=async s=>{x.value.page=s,await b()};return W(()=>{b(),z()}),(s,e)=>{var N,$,q;const u=Y("router-link");return o(),r("div",de,[t("div",ue,[e[11]||(e[11]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Forums Management",-1)),t("button",{onClick:R,class:"bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center"},[p(i(te),{class:"w-5 h-5 mr-2"}),e[10]||(e[10]=j(" Create Forum "))])]),t("div",ge,[y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>x.value.station_id=a),onChange:b,class:"px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500"},[e[12]||(e[12]=t("option",{value:""},"All Stations",-1)),(o(!0),r(F,null,S(D.value,a=>(o(),r("option",{key:a.id,value:a.id},n(a.name),9,ce))),128))],544),[[V,x.value.station_id]]),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>x.value.status=a),onChange:b,class:"px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500"},e[13]||(e[13]=[t("option",{value:""},"All Status",-1),t("option",{value:"1"},"Active",-1),t("option",{value:"0"},"Inactive",-1)]),544),[[V,x.value.status]])]),c.value==="fetchForums"?(o(),r("div",pe,[p(i(A),{class:"w-8 h-8 animate-spin text-purple-600"})])):($=(N=g.value)==null?void 0:N.data)!=null&&$.length?(o(),r("div",me,[(o(!0),r(F,null,S(g.value.data,a=>(o(),r("div",{key:a.id,class:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4 border border-gray-200 dark:border-slate-600"},[t("div",be,[t("div",xe,[p(u,{to:{name:"ForumDetails",params:{id:a.id}},class:"flex items-center gap-3 mb-2"},{default:Z(()=>[t("h3",ve,n(a.title),1),t("span",{class:E([a.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","px-2 py-1 rounded-full text-xs font-medium"])},n(a.status?"Active":"Inactive"),3),t("span",ye,n(P(a.station_id)),1)]),_:2},1032,["to"]),t("p",fe,n(a.body),1),t("div",ke,[t("span",null,"Created: "+n(I(a.created_at)),1),t("span",null,"Comments: "+n(a.comments_count||0),1)])]),t("div",he,[t("button",{onClick:T=>H(a),disabled:c.value==="updateForum",class:E(["p-2 rounded-lg transition-colors",a.status?"text-green-600 hover:bg-green-100 dark:hover:bg-green-900":"text-red-600 hover:bg-red-100 dark:hover:bg-red-900"])},[a.status?(o(),M(i(se),{key:1,class:"w-5 h-5"})):(o(),M(i(ae),{key:0,class:"w-5 h-5"}))],10,we),t("button",{onClick:T=>X(a),class:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900 rounded-lg transition-colors"},[p(i(oe),{class:"w-5 h-5"})],8,_e),t("button",{onClick:T=>J(a),class:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition-colors"},[p(i(re),{class:"w-5 h-5"})],8,Ce)])])]))),128)),g.value.total>g.value.per_page?(o(),r("div",Fe,[t("nav",Se,[(o(!0),r(F,null,S(L.value,a=>(o(),r("button",{key:a,onClick:T=>O(a),disabled:a===g.value.current_page,class:E(["px-3 py-2 rounded-lg text-sm font-medium transition-colors",a===g.value.current_page?"bg-purple-600 text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-600"])},n(a),11,Me))),128))])])):k("",!0)])):(o(),r("div",De,[p(i(le),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e[14]||(e[14]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"No forums found",-1)),e[15]||(e[15]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Create your first forum to get started",-1))])),h.value?(o(),r("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:_},[t("div",{onClick:e[6]||(e[6]=U(()=>{},["stop"])),class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4"},[t("div",Te,[t("h3",je,n(m.value?"Edit Forum":"Create Forum"),1),t("button",{onClick:_,class:"text-gray-400 hover:text-gray-600"},[p(i(ne),{class:"w-6 h-6"})])]),t("form",{onSubmit:U(G,["prevent"]),class:"p-6 space-y-4"},[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Radio Station ",-1)),y(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.station_id=a),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500"},[e[16]||(e[16]=t("option",{value:""},"Select Station",-1)),(o(!0),r(F,null,S(D.value,a=>(o(),r("option",{key:a.id,value:a.id},n(a.name),9,Ve))),128))],512),[[V,l.value.station_id]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Title ",-1)),y(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.title=a),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter forum title"},null,512),[[B,l.value.title]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),y(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.body=a),required:"",rows:"4",class:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter forum description"},null,512),[[B,l.value.body]])]),t("div",null,[t("label",Ee,[y(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.status=a),type:"checkbox",class:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,512),[[ee,l.value.status]]),e[20]||(e[20]=t("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Active",-1))])]),t("div",Ue,[t("button",{type:"button",onClick:_,class:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors"}," Cancel "),t("button",{type:"submit",disabled:c.value==="createForum"||c.value==="updateForum",class:"bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center"},[c.value==="createForum"||c.value==="updateForum"?(o(),M(i(A),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):k("",!0),j(" "+n(m.value?"Update":"Create"),1)],8,Ae)])],32)])])):k("",!0),f.value?(o(),r("div",{key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[9]||(e[9]=a=>f.value=!1)},[t("div",{onClick:e[8]||(e[8]=U(()=>{},["stop"])),class:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4"},[t("div",Ne,[t("div",$e,[p(i(ie),{class:"w-6 h-6 text-red-600 mr-3"}),e[21]||(e[21]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Delete Forum",-1))]),t("p",qe,' Are you sure you want to delete "'+n((q=w.value)==null?void 0:q.title)+'"? This action cannot be undone. ',1),t("div",Be,[t("button",{onClick:e[7]||(e[7]=a=>f.value=!1),class:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-600 rounded-lg transition-colors"}," Cancel "),t("button",{onClick:K,disabled:c.value==="deleteForum",class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center"},[c.value==="deleteForum"?(o(),M(i(A),{key:0,class:"w-4 h-4 mr-2 animate-spin"})):k("",!0),e[22]||(e[22]=j(" Delete "))],8,Le)])])])])):k("",!0)])}}};export{We as default};
