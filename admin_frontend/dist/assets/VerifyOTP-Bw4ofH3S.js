import{u as S,e as j,f,g as k,p as E,q as L,r as M,c as d,o as a,b as r,h as N,d as x,i as h,t as b,F as K,s as U,w as F,v as q,n as z,l as _,k as C,j as A,m as G}from"./index-nOqVMhSP.js";import{S as P}from"./shield-check-ctu1-iRh.js";import{C as H}from"./circle-alert-Srabv9G8.js";import{L as J}from"./loader-CmDhcKWI.js";import"./createLucideIcon-BxhE3_JV.js";const Q={class:"max-w-md w-full space-y-6 bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm p-10 rounded-xl shadow-2xl border border-purple-200 dark:border-slate-700"},W={class:"text-center"},X={class:"mx-auto w-12 h-12 bg-gradient-to-r from-purple-600 to-orange-500 rounded-full flex items-center justify-center mb-4"},Y={key:0,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},Z={class:"flex items-center"},$={class:"text-sm text-red-700 dark:text-red-400"},ee={class:"flex justify-center space-x-3"},te=["onUpdate:modelValue","onInput","onKeydown"],re=["disabled"],se={class:"text-center space-y-2"},oe=["disabled"],ae={key:0},le={key:1},ne={key:2},de={class:"text-center"},me={__name:"VerifyOTP",setup(ie){const g=S(),V=j(),c=f(!1),v=f(!1),l=f(["","","","","",""]),p=f([]),i=f(0);let m=null;const y=k(()=>g.state.auth.verifyError),T=k(()=>l.value.every(e=>e!=="")),D=(e,t)=>{var n;const s=t.target.value.replace(/[^0-9]/g,"");l.value[e]=s,s&&e<5&&((n=p.value[e+1])==null||n.focus())},I=(e,t)=>{var s;t.key==="Backspace"&&!l.value[e]&&e>0&&((s=p.value[e-1])==null||s.focus())},O=e=>{var s;e.preventDefault();const t=e.clipboardData.getData("text").replace(/[^0-9]/g,"").slice(0,6);for(let n=0;n<t.length;n++)l.value[n]=t[n];t.length>0&&((s=p.value[Math.min(t.length-1,5)])==null||s.focus())},B=async()=>{c.value=!0;try{const e=l.value.join("");await g.dispatch("auth/verifyOTP",{otp:e}),V.push("/new-password")}catch(e){console.error("OTP verification failed:",e)}finally{c.value=!1}},R=async()=>{v.value=!0;try{await g.dispatch("auth/resendOTP"),w()}catch(e){console.error("Resend failed:",e)}finally{v.value=!1}},w=()=>{i.value=60,m=setInterval(()=>{i.value--,i.value<=0&&clearInterval(m)},1e3)};return E(()=>{var e;(e=p.value[0])==null||e.focus(),w()}),L(()=>{m&&clearInterval(m)}),(e,t)=>{const s=M("router-link");return a(),d("div",Q,[r("div",W,[r("div",X,[x(h(P),{class:"w-6 h-6 text-white"})]),t[1]||(t[1]=r("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Verify OTP",-1)),t[2]||(t[2]=r("p",{class:"text-gray-600 dark:text-gray-300 mt-1"},"Enter the 6-digit code sent to your email",-1))]),y.value?(a(),d("div",Y,[r("div",Z,[x(h(H),{class:"h-5 w-5 text-red-500 mr-2"}),r("span",$,b(y.value),1)])])):N("",!0),r("form",{class:"space-y-6",onSubmit:G(B,["prevent"])},[r("div",null,[t[3]||(t[3]=r("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4 text-center"}," Verification Code ",-1)),r("div",ee,[(a(!0),d(K,null,U(l.value,(n,u)=>F((a(),d("input",{key:u,ref_for:!0,ref:o=>p.value[u]=o,"onUpdate:modelValue":o=>l.value[u]=o,onInput:o=>D(u,o),onKeydown:o=>I(u,o),onPaste:t[0]||(t[0]=o=>O(o)),type:"text",maxlength:"1",class:z(["w-12 h-12 text-center text-xl font-bold border border-gray-300 dark:border-slate-600 rounded-lg shadow-sm bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",{"border-red-300 focus:ring-red-500":y.value}])},null,42,te)),[[q,l.value[u]]])),128))])]),r("button",{type:"submit",disabled:c.value||!T.value,class:"relative w-full flex justify-center items-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"},[c.value?(a(),_(h(J),{key:0,class:"w-5 h-5 mr-2 animate-spin"})):(a(),_(h(P),{key:1,class:"w-5 h-5 mr-2"})),C(" "+b(c.value?"Verifying...":"Verify Code"),1)],8,re),r("div",se,[t[4]||(t[4]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Didn't receive the code? ",-1)),r("button",{type:"button",onClick:R,disabled:v.value||i.value>0,class:"text-sm font-medium text-purple-600 hover:text-purple-500 dark:text-purple-400 dark:hover:text-purple-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[v.value?(a(),d("span",ae,"Sending...")):i.value>0?(a(),d("span",le,"Resend in "+b(i.value)+"s",1)):(a(),d("span",ne,"Resend Code"))],8,oe)]),r("div",de,[x(s,{to:{name:"ResetPassword"},class:"text-sm font-medium text-purple-600 hover:text-purple-500 dark:text-purple-400 dark:hover:text-purple-300 transition-colors"},{default:A(()=>t[5]||(t[5]=[C(" Back to Reset Password ")])),_:1,__:[5]})])],32)])}}};export{me as default};
